<dom-module id="device-list">

  <style>
    paper-item {
      cursor: pointer;
    }
   </style>

  <template>
    <div class="list">
      <template is="dom-repeat" items="{{devices}}">
        <paper-item on-tap="selectDevice">
          <paper-item-body two-line class="layout vertical">
            <div>{{item.name}}</div>
            <div secondary>{{item.id}}</div>
          </paper-item-body>
        </paper-item>
      </template>
    </div>

    <spark-controller id="sparkController"
      on-response="handleResponse"
      on-error="handleError">
    </spark-controller>

  </template>

  <script>
    (function() {
      Polymer({
        is: 'device-list',

        properties : {
          devices : {
            type: Array,
            value: []
          },
          accessToken : {
            type: String
          },
        },

        refreshDevices : function(){
          this.$.sparkController.getDevices(this.accessToken);
        },

        handleError : function(){
        },

        handleResponse : function(e){
          this.devices = e.detail.response;
          this.fire('devices-loaded', null);
        },

        selectDevice : function(e){
          app.device = e.model.__data__.item;
          page('/remote');
        }

      });
      })();
  </script>

</dom-module>
